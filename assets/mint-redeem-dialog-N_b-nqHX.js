import{c as e,u as t,Y as s,j as n,au as a,av as r,aw as o,ax as i,B as c,ay as l,az as d,J as m,F as u,g as p,q as f,a as g,f as x,C as h,d as b,e as y,r as j,b as N,L as w,t as k,w as v,h as A,s as I,i as O,I as D,aA as S,aB as B,D as L,aC as C,E as P}from"./index-B22ef-ay.js";import{U as _}from"./USDTToken-sPSJkXxs.js";import{p as F}from"./parseEther-BEx39YpX.js";import{a as E,f as R,b as T,M as U,D as M,R as W,c as H}from"./fetchSubscribes-CkARwr9-.js";import{d as z}from"./dayjs.min-Ct18seUN.js";import{r as q}from"./router-AtcRQQB7.js";import{T as Y}from"./Token-D8m53OPG.js";import{B as G}from"./BoardTemplate-CYWzsBcW.js";function J(m){const u=e.c(27),{open:p,onOpenChange:f,onConfirm:g}=m,{t:x,i18n:h}=t();let b,y,j,N,w,k,v,A;b="en"===h.language?'OpenLoom Important Notice: \nThe Web3 market is highly risky. Please make sure you participate voluntarily, fully aware of the risks, and only invest an amount you can afford to lose. Before joining, carefully review the following statement and confirm that you completely understand and agree to the terms of this agreement.\n\n1. No Investment Advice or Guarantees: \nParticipation in any activity on OpenLoom — including but not limited to token launches, NFT sales, minting events, or lotteries — does not constitute financial advice. OpenLoom does not guarantee the success, profitability, or viability of any project hosted on its platform. All decisions made by users are their own and are undertaken at their sole discretion and risk. \n\n2. User Responsibility & Due Diligence:\nUsers are solely responsible for conducting their own research ("DYOR") before engaging with any project. OpenLoom does not conduct due diligence on the projects launched via its infrastructure and makes no claims regarding their legitimacy, quality, or long-term viability. Participation implies that users understand and accept all technical, legal, and financial risks involved. \n\n3. Third-Party Project Disclaimer:\nProjects deployed on OpenLoom are created and operated by independent third-party teams. OpenLoom is not involved in the strategy, management, tokenomics, or distribution models of these projects. As such, OpenLoom is not responsible for any project outcomes, failures, misconduct, or fraudulent activity committed by project creators. \n\n4. No Regulatory Compliance Guarantee:\nThe OpenLoom platform is open and permissionless. It does not monitor or enforce regulatory compliance for any project launched using its tools. Users are responsible for understanding the legal implications of participating in decentralized projects within their respective jurisdictions. OpenLoom shall not be held liable for any regulatory issues that may arise. \n\n5. Technical Risk & Samrt Contract Disclaimer:\nInteracting with blockchain-based systems inherently involves technical risks, including but not limited to smart contract bugs, protocol vulnerabilities, user errors, and network congestion. OpenLoom is committed to providing robust and secure infrastructure, and will undergo rigorous audits and security management. However, it still cannot guarantee the security of third-party contracts that may be involved. \n\n6. User Consent:\nBy interacting with any functionality provided by OpenLoom, users acknowledge and accept full responsibility for their actions and associated outcomes. Users agree that OpenLoom will not be held liable for any direct or indirect loss of assets, whether caused by market volatility, regulatory enforcement, or actions taken by third party project teams. \n\n7. Platform Security & Infrastructure Audits\nWhile OpenLoom does not audit third-party projects, it is committed to delivering a secure and reliable platform. All core infrastructure and smart contracts developed by OpenLoom are subject to thorough review and independent audits conducted by reputable third-party security firms to ensure the safety and integrity of the system. \n\nFinal Note \nOpenLoom is committed to improving the transparency, fairness, and accessibility of the Web3 launch process. While we strive to ensure a safe and seamless experience, we urge all users to remain cautious, informed, and responsible when participating in any blockchain activity.':"zh"===h.language?"OpenLoom重要提示：\nWeb3 市场风险极高，请务必在充分理解风险的前提下自愿参与，并确保您的投资金额在可承受范围内。参与前请仔细阅读以下声明并确认您已完全理解并完全接受以下协议。\n\n1.不提供投资建议或担保：\nOpenLoom是一个公共、去中心化、无需许可的平台,任何专案的创建不应被视为OpenLoom 的认可或推荐，我们不保证任何项目的成功或盈利，所有决策和风险均由用户自行承担。\n\n2.用户责任与尽职调查：\n参与任何项目前，用户应自行负责研究（DYOR）。 OpenLoom 不对第三方项目的合法性、质量或可行性做任何声明。参与即表示您理解并接受所有相关风险。\n\n3.第三方项目免责声明：\nOpenLoom 上部署的项目由第三方团队运营，我们对其结果、失败、不当行为或欺诈概不负责。\n\n4.没有监管合规保证：\n OpenLoom 平台不监控或强制项目合规性。用户有责任了解其所在管辖范围内的法律含义。我们对任何监管问题概不负责。\n\n5.技术风险和智能合约免责声明：\n基于区块链的交互存在技术风险，包括智能合约错误等。 OpenLoom 致力于提供安全基础设施，但无法保证第三方合约的安全性。\n\n6.用户同意：\n与 OpenLoom 交互即表示您承认并接受对自身行为及结果的全部责任。 OpenLoom 不对任何直接或间接的资产损失负责。\n\n7.平台安全和基础设施审计：\nOpenLoom 致力于提供安全平台，核心基础设施和智能合约已通过第三方安全审计。\n\n最后说明：\nOpenLoom 致力于提高 Web3 发布的透明度和可访问性，同时敦促用户在参与区块链活动时保持谨慎和责任感。":"zh_Hant"===h.language?"OpenLoom重要提示：\nWeb3 市場風險極高，請務必在充分理解風險的前提下自願參與，並確保您的投資金額在可承受範圍內。參與前請仔細閱讀以下聲明並確認您已完全理解並完全接受以下協議。\n\n1.不提供投資建議或擔保：\nOpenLoom是一個公共、去中心化、無需許可的平台,任何專案的創建不應被視為OpenLoom 的認可或推薦，我們不保證任何項目的成功或盈利，所有決策和風險均由用戶自行承擔。\n\n2.用戶責任與盡職調查：\n參與任何項目前，用戶應自行負責研究（DYOR）。OpenLoom 不對第三方項目的合法性、質量或可行性做任何聲明。參與即表示您理解並接受所有相關風險。\n\n3.第三方項目免責聲明：\n OpenLoom 上部署的項目由第三方團隊運營，我們對其結果、失敗、不當行為或欺詐概不負責。\n\n4.沒有監管合規保證：\n OpenLoom 平臺不監控或強制項目合規性。用戶有責任了解其所在管轄範圍內的法律含義。我們對任何監管問題概不負責。\n\n5.技術風險和智能合約免責聲明：\n基於區塊鏈的交互存在技術風險，包括智能合約錯誤等。OpenLoom 致力於提供安全基礎設施，但無法保證第三方合約的安全性。\n\n6.用戶同意： \n與 OpenLoom 交互即表示您承認並接受對自身行為及結果的全部責任。OpenLoom 不對任何直接或間接的資產損失負責。\n\n7.平臺安全和基礎設施審計： \nOpenLoom 致力於提供安全平臺，核心基礎設施和智能合約已通過第三方安全審計。\n\n最後說明：\nOpenLoom 致力於提高 Web3 發布的透明度和可訪問性，同時敦促用戶在參與區塊鏈活動時保持謹慎和責任感。\n":"Sorry, the language is not supported yet.",u[0]===Symbol.for("react.memo_cache_sentinel")?(y=s("w-[calc(100%-60px)] border-none bg-transparent p-0"),j=n.jsx(a,{hidden:!0}),N=n.jsx(r,{hidden:!0}),w=s("relative flex h-[calc(100vh-100px)] w-[calc(100vw-60px)] flex-col items-center rounded-2xl border bg-white px-[15px] pb-[30px] pt-[27px]","sm:h-[calc(80vh-0px)] sm:w-[520px]"),u[0]=y,u[1]=j,u[2]=N,u[3]=w):(y=u[0],j=u[1],N=u[2],w=u[3]),u[4]===Symbol.for("react.memo_cache_sentinel")?(k=n.jsx(o,{children:n.jsx("img",{src:i,alt:"Close",width:14,className:"absolute right-3 top-3 active:opacity-70"})}),u[4]=k):k=u[4],u[5]!==x?(v=x("Participation Agreement"),u[5]=x,u[6]=v):v=u[6],u[7]!==v?(A=n.jsx("span",{className:"text-[18px] text-[#101828]",children:v}),u[7]=v,u[8]=A):A=u[8];const I="en"==h.language&&"break-all";let O,D,S,B,L,C;return u[9]!==I?(O=s("no-scrollbar scrollbar h-full overflow-scroll whitespace-pre-wrap text-justify text-sm text-[#475467] lg:px-[15px]",I),u[9]=I,u[10]=O):O=u[10],u[11]!==b||u[12]!==O?(D=n.jsx("div",{className:"mt-5 h-[calc(100%-120px)] overflow-hidden",children:n.jsx("pre",{className:O,children:b})}),u[11]=b,u[12]=O,u[13]=D):D=u[13],u[14]!==x?(S=x("Confirm"),u[14]=x,u[15]=S):S=u[15],u[16]!==g||u[17]!==S?(B=n.jsx(c,{type:"primary",onClick:g,className:"absolute bottom-[30px] w-[calc(100%-30px)]",children:S}),u[16]=g,u[17]=S,u[18]=B):B=u[18],u[19]!==D||u[20]!==B||u[21]!==A?(L=n.jsxs(l,{className:y,children:[j,N,n.jsxs("div",{className:w,children:[k,A,D,B]})]}),u[19]=D,u[20]=B,u[21]=A,u[22]=L):L=u[22],u[23]!==f||u[24]!==p||u[25]!==L?(C=n.jsx(d,{open:p,onOpenChange:f,children:L}),u[23]=f,u[24]=p,u[25]=L,u[26]=C):C=u[26],C}async function K(e,t=5){if(t<0||t>100)return Promise.reject("Invalid fee rate");const s=await f(p,{abi:Y.abi,address:e.tokenAddress,functionName:"pair"}).catch((e=>{}));return s?await m(p,{contracts:[{abi:Y.abi,address:s,functionName:"balanceOf",args:[e.boardAddress]},{abi:Y.abi,address:s,functionName:"totalSupply"},{abi:Y.abi,address:e.usdtAddress,functionName:"balanceOf",args:[s]},{abi:Y.abi,address:e.tokenAddress,functionName:"balanceOf",args:[s]},{abi:G.abi,address:e.boardAddress,functionName:"releaseRadio"}]}).then((e=>{const[s,n,a,r,o]=e;if("success"===s.status&&"success"===n.status&&"success"===a.status&&"success"===r.status&&"success"===o.status){const e=s.result*o.result/BigInt(1e12),i=a.result*e/n.result;return i*r.result/(a.result+i)*BigInt("997")/BigInt("1000")*BigInt(t)/BigInt("100")}return Promise.reject("Failed to get release amount out")})):Promise.reject("Release pair address not found")}async function $(e,t,s=5){if(s<0||s>100)return Promise.reject("Invalid fee rate");const n=await m(p,{contracts:[{abi:u.abi,address:e.forgeAddress,functionName:"router"},{abi:u.abi,address:e.forgeAddress,functionName:"mintRatio"},{abi:u.abi,address:e.forgeAddress,functionName:"earn",args:[t]},{abi:u.abi,address:e.forgeAddress,functionName:"cardInfoOf",args:[t]}]}).catch((e=>{}));if(!n)return Promise.reject("Failed to get router and mint ratio");const[a,r,o,i]=n;if("success"!==a.status||"success"!==r.status||"success"!==o.status||"success"!==i.status)return Promise.reject("Failed to get router and mint ratio");const c=i.result[1];c-o.result<=BigInt(1e18)&&(o.result=c);const l=o.result*(BigInt(1e12)-r.result)/BigInt(1e12);if(o.result*(BigInt(1e12)-r.result)==BigInt("0"))return BigInt(0);const d=await f(p,{abi:q,address:a.result,functionName:"getAmountsOut",args:[l,[e.tokenAddress,e.usdtAddress]]}).catch((e=>{}));return d?d[1]*BigInt("997")/BigInt("1000")*BigInt(s)/BigInt("100"):Promise.reject("Failed to get amounts out")}const Q=[100,500,1e3,5e3,1e4],V=a=>{const r=e.c(83),{open:o,onOpenChange:i,onrefresh:l}=a,{t:d,i18n:C}=t(),{toast:P}=g(),E=x(),{address:R}=h(),{tokenList:T}=b(),{role:U}=y(),[M,W]=j.useState(""),[H,z]=j.useState(!1),[Y,G]=j.useState(!1),[K,$]=j.useState(!1);let V;r[0]===Symbol.for("react.memo_cache_sentinel")?(V=e=>{W(e)},r[0]=V):V=r[0];const X=V,[Z,ee]=j.useState(0),te=N();let se;r[1]!==o?(se=[o],r[1]=o,r[2]=se):se=r[2],j.useEffect((()=>{$(!1),o&&ne()}),se);const ne=async()=>{const e=await f(p,{abi:_.abi,address:_.networks[E].address,functionName:"balanceOf",args:[R]});ee(Number(w(e)))};let ae;r[3]===Symbol.for("react.memo_cache_sentinel")?(ae=e=>{Number(e.target.value)>1e5?W("100000"):W(e.target.value)},r[3]=ae):ae=r[3];const re=ae;let oe;r[4]!==H?(oe=()=>{H?z(!1):G(!0)},r[4]=H,r[5]=oe):oe=r[5];const ie=oe;let ce;r[6]===Symbol.for("react.memo_cache_sentinel")?(ce=e=>G(e),r[6]=ce):ce=r[6];const le=ce;let de;r[7]===Symbol.for("react.memo_cache_sentinel")?(de=()=>{G(!1),z(!0)},r[7]=de):de=r[7];const me=de;let ue,pe;if(r[8]!==R||r[9]!==M||r[10]!==E||r[11]!==H||r[12]!==i||r[13]!==l||r[14]!==te||r[15]!==U||r[16]!==d||r[17]!==P||r[18]!==T){ue=async()=>{if(!H)return G(!0);if(Number(M)%100!=0)return P(d("newDetails.MintDialog.text7"));if(0==Number(M))return P(d("newDetails.MintDialog.text7"));const t=await f(p,{abi:_.abi,address:_.networks[E].address,functionName:"balanceOf",args:[R]});if(Number(M)>Number(w(t)))return P(d("newDetails.MintDialog.text8"));if(T)try{$(!0);const t=await f(p,{abi:_.abi,address:_.networks[E].address,functionName:"allowance",args:[R,T[U.tokenSubscript].forge]});if(Number(M)<=Number(w(t)))e();else{const t=await v(p,{abi:_.abi,address:_.networks[E].address,functionName:"approve",args:[T[U.tokenSubscript].forge,F("1000000")]});await A(p,{hash:t}),await e()}}catch(s){$(!1)}};const e=async()=>{if(T)try{const e=F(String(M)),t=await async function(e,t,s=5){if(s<0||s>100)return Promise.reject("Invalid fee rate");const n=await m(p,{contracts:[{abi:u.abi,address:e.forgeAddress,functionName:"router"},{abi:u.abi,address:e.forgeAddress,functionName:"mintRatio"}]}).catch((e=>{}));if(!n)return Promise.reject("Failed to get router and mint ratio");const[a,r]=n;if("success"!==a.status||"success"!==r.status)return Promise.reject("Failed to get router and mint ratio");const o=t*(BigInt(1e12)-r.result)/BigInt(2e12);if(o==BigInt("0"))return BigInt(0);const i=await f(p,{abi:q,address:a.result,functionName:"getAmountsOut",args:[o,[e.tokenAddress,e.usdtAddress]]}).catch((e=>{}));return i?i[1]*BigInt("997")/BigInt("1000")*BigInt(s)/BigInt("100"):Promise.reject("Failed to get amounts out")}({tokenAddress:T[U.tokenSubscript].token,usdtAddress:_.networks[E].address,boardAddress:T[U.tokenSubscript].board,forgeAddress:T[U.tokenSubscript].forge},e),{request:s}=await I(p,{abi:u.abi,address:T[U.tokenSubscript].forge,functionName:"subscribe",args:[BigInt(U.tokenId),e,t]}),a=await v(p,s),r=await A(p,{hash:a});await O(te,r.blockNumber),P(n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"text-[#A4E940]",children:d("newDetails.MintDialog.text9")}),n.jsxs("div",{children:[M," USDT"]})]})),$(!1),l(),i()}catch(e){$(!1)}};r[8]=R,r[9]=M,r[10]=E,r[11]=H,r[12]=i,r[13]=l,r[14]=te,r[15]=U,r[16]=d,r[17]=P,r[18]=T,r[19]=ue}else ue=r[19];r[20]!==i?(pe=()=>{i(),W("")},r[20]=i,r[21]=pe):pe=r[21];const fe=pe;let ge,xe,he,be,ye,je,Ne,we,ke,ve,Ae,Ie,Oe,De,Se;r[22]!==d?(ge=d("newDetails.MintDialog.text1"),r[22]=d,r[23]=ge):ge=r[23],r[24]!==ge?(xe=n.jsx("span",{className:"text-base text-[#101828]",children:ge}),r[24]=ge,r[25]=xe):xe=r[25],r[26]!==d?(he=d("newDetails.MintDialog.text2"),r[26]=d,r[27]=he):he=r[27],r[28]!==he?(be=n.jsxs("span",{className:"text-sm text-[#475467]",children:[" ",he]}),r[28]=he,r[29]=be):be=r[29],r[30]!==be||r[31]!==xe?(ye=n.jsxs("div",{className:"flex flex-col",children:[xe,be]}),r[30]=be,r[31]=xe,r[32]=ye):ye=r[32],r[33]!==M?(je=n.jsx(D,{value:M,onInput:re,placeholder:"100-100000",className:"mt-3.5 h-auto border-none bg-[#ECECED] p-3.5 text-lg/tight font-semibold text-black placeholder:text-[#8A8A8A]/30"}),r[33]=M,r[34]=je):je=r[34],r[35]!==M?(Ne=Q.map((e=>n.jsx("span",{onClick:()=>X(String(e)),className:s("rounded-lg border border-[#D0D5DD] bg-white py-1.5 text-center text-sm text-[#3D3D3D]",e===Number(M)&&"border-[#3D3D3D]"),children:e},e))),r[35]=M,r[36]=Ne):Ne=r[36],r[37]===Symbol.for("react.memo_cache_sentinel")?(we=n.jsx("span",{className:s("rounded-lg bg-white py-1.5 text-center text-sm text-[#3D3D3D]"),children:"....."}),r[37]=we):we=r[37],r[38]!==Ne?(ke=n.jsxs("div",{className:"mt-3.5 grid grid-cols-3 gap-x-2 gap-y-1.5",children:[Ne,we]}),r[38]=Ne,r[39]=ke):ke=r[39],r[40]!==d?(ve=d("newDetails.MintDialog.text10"),r[40]=d,r[41]=ve):ve=r[41],r[42]!==Z?(Ae=k(Z,2),r[42]=Z,r[43]=Ae):Ae=r[43],r[44]!==Ae?(Ie=n.jsxs("div",{className:"ml-[5px] text-[#475467]",children:[Ae," USDT"]}),r[44]=Ae,r[45]=Ie):Ie=r[45],r[46]!==ve||r[47]!==Ie?(Oe=n.jsx("div",{className:"my-3",children:n.jsxs("div",{className:"flex items-center text-[13px] text-[#101828]",children:[ve,Ie]})}),r[46]=ve,r[47]=Ie,r[48]=Oe):Oe=r[48],r[49]!==d?(De=d("newDetails.MintDialog.text3"),r[49]=d,r[50]=De):De=r[50],r[51]!==K||r[52]!==ue||r[53]!==De?(Se=n.jsx(c,{isLoading:K,onClick:ue,type:"green",className:"w-full px-3.5 font-medium",children:De}),r[51]=K,r[52]=ue,r[53]=De,r[54]=Se):Se=r[54];const Be="en"===C.language&&"mt-4";let Le,Ce,Pe,_e,Fe,Ee,Re,Te,Ue;return r[55]!==Be?(Le=s("mt-6 flex items-start justify-center sm:items-center",Be),r[55]=Be,r[56]=Le):Le=r[56],r[57]!==H?(Ce=H?n.jsx(S,{className:"mainColor h-[15px] w-[15px]"}):n.jsx("i",{className:"h-[12px] w-[12px] shrink-0 border border-black"}),r[57]=H,r[58]=Ce):Ce=r[58],r[59]===Symbol.for("react.memo_cache_sentinel")?(Pe=n.jsx("span",{className:"border-b border-[#D7A001] font-normal text-[#D7A001]",children:"User Agreement"}),r[59]=Pe):Pe=r[59],r[60]!==d?(_e=n.jsx("span",{className:"ml-1 max-w-72 whitespace-pre-wrap text-[10px]/normal text-[#333333] sm:max-w-full lg:text-[14px]",children:n.jsxs(B,{t:d,i18nKey:"I have carefully read and fully understood the Privacy Agreement, Risk Warning and User Agreement2.",children:["I have carefully read and fully understood the"," ",Pe,"."]})}),r[60]=d,r[61]=_e):_e=r[61],r[62]!==ie||r[63]!==Le||r[64]!==Ce||r[65]!==_e?(Fe=n.jsxs("div",{className:Le,onClick:ie,children:[Ce,_e]}),r[62]=ie,r[63]=Le,r[64]=Ce,r[65]=_e,r[66]=Fe):Fe=r[66],r[67]!==Se||r[68]!==Fe?(Ee=n.jsxs("div",{className:"mt-2 flex flex-col items-center",children:[Se,Fe]}),r[67]=Se,r[68]=Fe,r[69]=Ee):Ee=r[69],r[70]!==fe||r[71]!==o||r[72]!==ye||r[73]!==je||r[74]!==ke||r[75]!==Oe||r[76]!==Ee?(Re=n.jsxs(L,{open:o,onOpenChange:fe,className:"px-5 py-4",children:[ye,je,ke,Oe,Ee]}),r[70]=fe,r[71]=o,r[72]=ye,r[73]=je,r[74]=ke,r[75]=Oe,r[76]=Ee,r[77]=Re):Re=r[77],r[78]!==Y?(Te=n.jsx(J,{open:Y,onOpenChange:le,onConfirm:me}),r[78]=Y,r[79]=Te):Te=r[79],r[80]!==Re||r[81]!==Te?(Ue=n.jsxs(n.Fragment,{children:[Re,Te]}),r[80]=Re,r[81]=Te,r[82]=Ue):Ue=r[82],Ue};function X(s){const a=e.c(40),{isOpen:r,onClose:o}=s,{t:i}=t(),c=N(),{role:l}=y(),{token:d,tokenList:m}=b(),[u,p]=j.useState();let f,g,x,h,v,A,I,O,D;a[0]!==i?(f=i("history.OperateHistory.text1"),a[0]=i,a[1]=f):f=a[1],a[2]!==f?(g={icon:U,title:f,color:"#4CAF50"},a[2]=f,a[3]=g):g=a[3],a[4]!==i?(x=i("history.OperateHistory.text2"),a[4]=i,a[5]=x):x=a[5],a[6]!==x?(h={icon:M,title:x,color:"#3B82F6"},a[6]=x,a[7]=h):h=a[7],a[8]!==i?(v=i("history.OperateHistory.text3"),a[8]=i,a[9]=v):v=a[9],a[10]!==v?(A={icon:W,title:v,color:"#EAB308"},a[10]=v,a[11]=A):A=a[11],a[12]!==i?(I=i("history.OperateHistory.text4"),a[12]=i,a[13]=I):I=a[13],a[14]!==I?(O={icon:H,title:I,color:"#F97316"},a[14]=I,a[15]=O):O=a[15],a[16]!==g||a[17]!==h||a[18]!==A||a[19]!==O?(D={mint:g,delegate:h,take:A,redeem:O},a[16]=g,a[17]=h,a[18]=A,a[19]=O,a[20]=D):D=a[20];const S=D;let B;a[21]!==r||a[22]!==l||a[23]!==m?(B=[r,m,l],a[21]=r,a[22]=l,a[23]=m,a[24]=B):B=a[24],j.useEffect((()=>{r&&_()}),B);const _=async()=>{if(d&&l.tokenId>0){const e=await E(c,{where:{cardId:Number(l.tokenId),token:m[l.tokenSubscript].token}}),t=await R(c,{orderBy:"createAt",where:{cardId:Number(l.tokenId),token:m[l.tokenSubscript].token}}),s=await T(c,{where:{cardId:Number(l.tokenId),token:m[l.tokenSubscript].token}}),n=e.map(se),a=t.map(te),r=s.map(ee),o=a.concat(n).concat(r);o.sort(Z),p(o)}};let F,z,q,Y,G;return a[25]!==i?(F=i("history.OperateHistory.text5"),a[25]=i,a[26]=F):F=a[26],a[27]!==F?(z=n.jsx("span",{className:"text-[20px] text-[#101828]",children:F}),a[27]=F,a[28]=z):z=a[28],a[29]!==S||a[30]!==u||a[31]!==i?(q=n.jsx("div",{className:"no-scrollbar mt-5 h-[500px] w-full space-y-4 overflow-scroll",children:u&&u.length>0?n.jsx(n.Fragment,{children:null==u?void 0:u.map(((e,t)=>n.jsxs("div",{className:"flex items-end justify-between rounded-xl p-4 text-[18px] text-sm shadow-[0_2px_4px_0_rgba(0,0,0,0.05)]",children:[n.jsxs("div",{className:"flex items-center space-x-4",children:[n.jsx("img",{src:S[e.type].icon,alt:"type",className:"w-10"}),n.jsxs("div",{className:"flex flex-col space-y-1",children:[n.jsxs("span",{className:"text-[16px] text-[#111827]",children:[S[e.type].title," "]}),n.jsx("span",{className:"text-[14px] text-[#6B7280]",children:C(String(e.createAt))})]})]}),n.jsxs("span",{style:{color:S[e.type].color},className:"text-[14px]",children:[["mint","take"].includes(e.type)&&"+",k(w(BigInt(e.mintAmount)))]})]},t)))}):n.jsx(P,{text:i("noData"),imageWidth:97.5,divclassName:"mt-[50px] py-0 sm:mt-[130px]",className:"text-[#8A8A8A] sm:mt-[10px] sm:text-[17px]"})}),a[29]=S,a[30]=u,a[31]=i,a[32]=q):q=a[32],a[33]!==z||a[34]!==q?(Y=n.jsxs("div",{className:"flex flex-col",children:[z,q]}),a[33]=z,a[34]=q,a[35]=Y):Y=a[35],a[36]!==r||a[37]!==o||a[38]!==Y?(G=n.jsx(L,{open:r,onOpenChange:o,className:"px-5 py-4",children:Y}),a[36]=r,a[37]=o,a[38]=Y,a[39]=G):G=a[39],G}function Z(e,t){const s=z(e.createAt).valueOf();return z(t.createAt).valueOf()-s}function ee(e){return{cardId:e.cardId,createAt:e.createAt,id:e.id,mintAmount:String(e.amount),token:e.token,type:"redeem"}}function te(e){return{cardId:e.cardId,createAt:e.createAt,id:e.id,mintAmount:String(e.amount),token:e.token,type:"delegate"}}function se(e){return{cardId:e.cardId,createAt:e.createAt,id:e.id,mintAmount:e.tokenAmount,token:e.token,type:"mint"}}const ne=s=>{const a=e.c(61),{open:r,onOpenChange:o,currentSupply:i,onrefresh:l}=s,{t:d}=t(),{toast:h}=g(),{tokenList:N}=b(),{role:O}=y(),[S,B]=j.useState(""),C=x(),[P,E]=j.useState(!1),[R,T]=j.useState(!1);let U;a[0]!==i?(U=e=>{const t=e.target.value;/^[0-9]*\.?[0-9]*$/.test(t)&&B(t),F(String(e.target.value))>i?T(!0):T(!1)},a[0]=i,a[1]=U):U=a[1];const M=U;let W,H,z,Y,G,J,K,$,Q,V,X,Z,ee,te,se,ne,ae,re,oe,ie;return a[2]!==S||a[3]!==i?(W=()=>{F(String(S))>i?T(!0):T(!1)},a[2]=S,a[3]=i,a[4]=W):W=a[4],a[5]!==S?(H=[S],a[5]=S,a[6]=H):H=a[6],j.useEffect(W,H),a[7]===Symbol.for("react.memo_cache_sentinel")?(z=()=>{E(!1)},a[7]=z):z=a[7],a[8]!==r?(Y=[r],a[8]=r,a[9]=Y):Y=a[9],j.useEffect(z,Y),a[10]!==S||a[11]!==C||a[12]!==i||a[13]!==o||a[14]!==l||a[15]!==O||a[16]!==d||a[17]!==h||a[18]!==N?(J=async()=>{if(isNaN(Number(S))||Number(S)<=0)return h(d("than0"));if(Number(S)>Number(i))return h(d("redeem.text4"));const e=F(String(S));try{E(!0);const t=await async function(e,t,s=5){if(s<0||s>100)return Promise.reject("Invalid fee rate");const n=await m(p,{contracts:[{abi:u.abi,address:e.forgeAddress,functionName:"router"},{abi:u.abi,address:e.forgeAddress,functionName:"mintRatio"},{abi:u.abi,address:e.forgeAddress,functionName:"earn",args:[t]}]}).catch((e=>{}));if(!n)return Promise.reject("Failed to get router and mint ratio");const[a,r,o]=n;if("success"!==a.status||"success"!==r.status||"success"!==o.status)return Promise.reject("Failed to get router and mint ratio");const i=o.result*(BigInt(1e12)-r.result)/BigInt(1e12);if(o.result*(BigInt(1e12)-r.result)==BigInt("0"))return BigInt(0);const c=await f(p,{abi:q,address:a.result,functionName:"getAmountsOut",args:[i,[e.tokenAddress,e.usdtAddress]]}).catch((e=>{}));return c?c[1]*BigInt("997")/BigInt("1000")*BigInt(s)/BigInt("100"):Promise.reject("Failed to get amounts out")}({tokenAddress:N[O.tokenSubscript].token,usdtAddress:_.networks[C].address,boardAddress:N[O.tokenSubscript].board,forgeAddress:N[O.tokenSubscript].forge},BigInt(O.tokenId),5),{request:s}=await I(p,{abi:u.abi,address:N[O.tokenSubscript].forge,functionName:"ransom",args:[BigInt(O.tokenId),e,t]}),a=await v(p,s);await A(p,{hash:a}),h(n.jsx(n.Fragment,{children:n.jsxs("span",{className:"text-[#A4E940]",children:[d("newDetails.text39")," "]})})),l(),G(),E(!1)}catch(t){E(!1)}},G=()=>{o(),B("")},a[10]=S,a[11]=C,a[12]=i,a[13]=o,a[14]=l,a[15]=O,a[16]=d,a[17]=h,a[18]=N,a[19]=G,a[20]=J):(G=a[19],J=a[20]),a[21]!==d?(K=d("redeem.text1"),a[21]=d,a[22]=K):K=a[22],a[23]!==K?($=n.jsx("div",{className:"flex flex-col",children:n.jsx("span",{className:"text-base text-[#101828]",children:K})}),a[23]=K,a[24]=$):$=a[24],a[25]!==S||a[26]!==M?(Q=n.jsx(D,{value:S,onInput:M,placeholder:"",type:"number",className:"flex-1 rounded-br-none rounded-tr-none border-none bg-[#ECECED] text-[14px]/tight font-semibold text-[#8A8A8A]"}),a[25]=S,a[26]=M,a[27]=Q):Q=a[27],a[28]!==i?(V=()=>B(k(w(i))),a[28]=i,a[29]=V):V=a[29],a[30]!==d?(X=d("max"),a[30]=d,a[31]=X):X=a[31],a[32]!==X||a[33]!==V?(Z=n.jsx("div",{onClick:V,className:"flex h-full cursor-pointer items-center justify-center text-[14px] font-medium text-[#8A8A8A]",children:X}),a[32]=X,a[33]=V,a[34]=Z):Z=a[34],a[35]!==Z||a[36]!==Q?(ee=n.jsxs("div",{className:"mt-[21px] flex items-center rounded-lg bg-[#ECECED] p-[7px_15px]",children:[Q,Z]}),a[35]=Z,a[36]=Q,a[37]=ee):ee=a[37],a[38]!==d?(te=d("redeem.text3"),a[38]=d,a[39]=te):te=a[39],a[40]!==te?(se=n.jsx("span",{className:"",children:te}),a[40]=te,a[41]=se):se=a[41],a[42]!==i?(ne=k(w(i)),a[42]=i,a[43]=ne):ne=a[43],a[44]!==se||a[45]!==ne?(ae=n.jsxs("div",{className:"mt-[20px] flex w-full justify-between text-[16px] text-[#101828]",children:[se,ne," USDT"]}),a[44]=se,a[45]=ne,a[46]=ae):ae=a[46],a[47]!==d?(re=d("redeem.text2"),a[47]=d,a[48]=re):re=a[48],a[49]!==R||a[50]!==P||a[51]!==J||a[52]!==re?(oe=n.jsx("div",{className:"mb-[20px] mt-[20px] flex flex-col items-center",children:n.jsx(c,{disabled:R,isLoading:P,onClick:J,type:"green",className:"w-full px-3.5 font-medium",children:re})}),a[49]=R,a[50]=P,a[51]=J,a[52]=re,a[53]=oe):oe=a[53],a[54]!==G||a[55]!==r||a[56]!==ee||a[57]!==ae||a[58]!==oe||a[59]!==$?(ie=n.jsx(n.Fragment,{children:n.jsxs(L,{open:r,onOpenChange:G,className:"px-5 py-4",children:[$,ee,ae,oe]})}),a[54]=G,a[55]=r,a[56]=ee,a[57]=ae,a[58]=oe,a[59]=$,a[60]=ie):ie=a[60],ie};export{V as M,X as O,ne as a,K as b,$ as g};
